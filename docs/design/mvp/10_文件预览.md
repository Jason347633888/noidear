# 文件预览（Phase 11）

> **来源**: DESIGN.md 第十三章（Phase 11）  
> **文档版本**: 1.0  
> **最后更新**: 2026-02-14  
> **实现状态**: ⚠️ 部分实现（PDF 已实现，Word/Excel 待完善）  
> **代码位置**: `client/src/components/PdfViewer.vue`

---

## 1. 功能概述

文件预览系统，支持 PDF、Word、Excel 全格式原生预览。

### 1.1 核心特性

- ✅ **PDF 预览**: 原生 PDF 预览（已实现）
- ⏳ **Word 预览**: Office Online Viewer（待实现）
- ⏳ **Excel 预览**: Office Online Viewer（待实现）
- ✅ **预览组件**: PdfViewer.vue 组件

---

## 2. 预览功能

### 2.1 支持的文件类型

| 文件类型 | 预览方式 | 实现状态 |
|---------|---------|---------|
| **PDF** | 原生 `<embed>` 标签 | ✅ 已实现 |
| **Word** | Office Online Viewer | ⏳ 待实现 |
| **Excel** | Office Online Viewer | ⏳ 待实现 |

### 2.2 PDF 预览组件

**组件路径**: `client/src/components/PdfViewer.vue`

**使用示例**:
```vue
<template>
  <PdfViewer :url="pdfUrl" />
</template>

<script setup>
import PdfViewer from '@/components/PdfViewer.vue'

const pdfUrl = 'https://minio.example.com/documents/1-RD-001/v1.0/quality-manual.pdf'
</script>
```

**组件代码**:
```vue
<template>
  <embed
    :src="url"
    type="application/pdf"
    width="100%"
    height="600px"
  />
</template>

<script setup>
defineProps<{
  url: string
}>()
</script>
```

---

## 3. Word/Excel 预览（待实现 ⏳）

### 3.1 方案一：Office Online Viewer

**优点**: 官方支持，渲染效果好  
**缺点**: 需要公网访问

**URL 格式**:
```
https://view.officeapps.live.com/op/embed.aspx?src=<文件URL>
```

### 3.2 方案二：前端渲染库

| 文件类型 | 推荐库 | 说明 |
|---------|--------|------|
| **Word** | mammoth.js | 将 .docx 转换为 HTML |
| **Excel** | SheetJS | 渲染 Excel 表格 |

---

**本文档完成 ✅**
