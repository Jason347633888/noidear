# MVP 业务规则汇总（BR-001 ~ BR-024）

> **来源**: DESIGN.md 第五章（业务规则） + 第十三章（Phase 7-12）  
> **文档版本**: 1.0  
> **最后更新**: 2026-02-14  
> **规则数量**: 24 条（BR-001 ~ BR-024）

---

## 目录

- [文档管理规则（BR-001 ~ BR-008）](#文档管理规则)
- [任务管理规则（BR-009, BR-014, BR-014a）](#任务管理规则)
- [审批流程规则（BR-002, BR-004, BR-006, BR-012）](#审批流程规则)
- [用户管理规则（BR-015, BR-016）](#用户管理规则)
- [权限管理规则（BR-017, BR-018, BR-019）](#权限管理规则)
- [偏离检测规则（BR-017 ~ BR-024）](#偏离检测规则)

---

## 文档管理规则

| 规则编号 | 规则描述 | 所属模块 |
|---------|----------|---------|
| **BR-001** | 编号规则配置后，新文件自动按规则生成文件编号 | 三级文档管理 |
| **BR-002** | 一级/二级/三级文件创建后必须提交审批，不审批不可发布 | 审批流程 |
| **BR-003** | 四级文件（模板）创建后直接发布，无需审批 | 模板管理 |
| **BR-004** | 四级文件（记录）填写后提交审批，审批通过后归档 | 任务管理 + 审批流程 |
| **BR-005** | 模板停用后，不可再新建数据，历史数据可查询 | 模板管理 |
| **BR-006** | 文件提交后不允许修改，只能查看或撤回 | 三级文档管理 |
| **BR-007** | 文件名称同级别内不可重复 | 三级文档管理 |
| **BR-008** | 编号删除后，系统记录待补齐编号，下次新建时优先使用 | 三级文档管理 |

---

## 任务管理规则

| 规则编号 | 规则描述 | 所属模块 |
|---------|----------|---------|
| **BR-009** | 任务必须指定执行人，否则无法分发 | 任务管理 |
| **BR-014** | 任务第一人提交后，其他人不能再提交，只能查看 | 任务管理 |
| **BR-014a** | 任务发给部门，部门内任意一人都可填写 | 任务管理 |

---

## 审批流程规则

| 规则编号 | 规则描述 | 所属模块 |
|---------|----------|---------|
| **BR-002** | 一级/二级/三级文件创建后必须提交审批，不审批不可发布 | 审批流程 |
| **BR-004** | 四级文件（记录）填写后提交审批，审批通过后归档 | 审批流程 |
| **BR-006** | 文件提交后不允许修改，只能查看或撤回 | 审批流程 |
| **BR-012** | 审批驳回时必须填写驳回原因 | 审批流程 |

---

## 用户管理规则

| 规则编号 | 规则描述 | 所属模块 |
|---------|----------|---------|
| **BR-010** | 归档后的数据不可修改，只能查看 | 回收站 |
| **BR-011** | 不同级别的文件使用不同的编号序列 | 三级文档管理 |
| **BR-013** | 文件修改后自动+版本号（1.0→1.1→1.2） | 三级文档管理 |
| **BR-015** | 用户名唯一，英文+数字，最小3位 | 权限管理 |
| **BR-016** | 密码最小8位，无需复杂度和特殊字符 | 权限管理 |

---

## 权限管理规则（P0-3 修复）

| 规则编号 | 规则描述 | 所属模块 |
|---------|----------|---------|
| **BR-017** | 质量部和管理层拥有 viewAllRecords 权限，可跨部门查看所有记录 | 权限管理（P0-3 修复） |
| **BR-018** | 质量部和管理层拥有 MODIFY_APPROVED_RECORD 权限，可修改已审批记录 | 权限管理（P0-3 修复） |
| **BR-019** | 普通员工只能查看本部门创建的记录，不可跨部门查看 | 权限管理（P0-3 修复） |

---

## 偏离检测规则（Phase 7-8）

| 规则编号 | 规则描述 | 所属模块 |
|---------|----------|---------|
| **BR-017 (重复编号)** | 数值型字段可配置公差（范围公差 or 百分比公差），非数值型字段不支持 | 配方偏离检测 |
| **BR-018 (重复编号)** | 偏离检测结果实时显示，不阻塞填写 | 配方偏离检测 |
| **BR-019 (重复编号)** | 提交时若有偏离，强制弹窗填写原因（每个偏离字段一个原因） | 配方偏离检测 |
| **BR-020** | 偏离原因最少10个字符，最多500个字符 | 配方偏离检测 |
| **BR-021** | 一个任务记录可以包含多个偏离字段，每个字段生成一条偏离报告 | 配方偏离检测 |
| **BR-022** | 偏离报告不可修改，只能查看和审批 | 配方偏离检测 |
| **BR-023** | 员工提交记录时，系统自动锁定配方版本号 | 配方偏离检测 |
| **BR-024** | 提交后的记录，版本号永久锁定，不可修改 | 配方偏离检测 |

**注**: BR-017 ~ BR-019 在 DESIGN.md 中重复编号，需要重新编排为 BR-025 ~ BR-027。

---

## 规则统计

| 模块 | 规则数量 | 规则编号 |
|------|---------|---------|
| **三级文档管理** | 8 | BR-001, BR-006, BR-007, BR-008, BR-011, BR-013 |
| **模板管理** | 2 | BR-003, BR-005 |
| **任务管理** | 3 | BR-009, BR-014, BR-014a |
| **审批流程** | 4 | BR-002, BR-004, BR-006, BR-012 |
| **权限管理** | 5 | BR-015, BR-016, BR-017, BR-018, BR-019 |
| **回收站** | 1 | BR-010 |
| **配方偏离检测** | 8 | BR-017 ~ BR-024 |
| **总计** | 24 | BR-001 ~ BR-024 |

---

**本文档完成 ✅**
