# P1-1: Document 归档/作废功能完整方案

> **来源**: DESIGN.md 第 22.2.1 节
> **优先级**: P0（紧急）
> **估时**: 2-3 小时
> **依赖**: Document 表（Layer 0 已实现）
> **状态**: 完整方案已完成，待实施

---

## 📋 业务规则补充

### BR-346: 文档归档规则

- **归档条件**: 文档状态必须为 `approved`（已发布），不能归档草稿或审核中的文档
- **归档原因**: 必填，最少 10 个字符，说明归档原因
- **归档权限**: 仅文档创建者或管理员可归档
- **归档后状态**: 文档状态变更为 `archived`，不可再编辑
- **归档后访问**: 归档后仍可查看和下载，但搜索时默认不显示（需勾选"包含归档文档"）

### BR-347: 文档作废规则

- **作废条件**: 文档状态必须为 `approved`（已发布）
- **作废原因**: 必填，最少 10 个字符，说明作废原因（如"发现重大错误"、"流程变更"）
- **作废权限**: 仅质量部管理员或系统管理员可作废文档
- **作废后状态**: 文档状态变更为 `obsolete`，完全不可编辑
- **作废后访问**: 作废后仍可查看（只读），但搜索时默认不显示，需勾选"包含作废文档"
- **作废通知**: 作废后自动通知所有曾引用该文档的用户

### BR-348: 归档/作废文档恢复规则

- **归档恢复**: 归档的文档可恢复到 `approved` 状态，需提供恢复原因
- **作废不可恢复**: 作废的文档不可恢复，符合 BRCGS 3.11.2 要求（作废文档应永久标记）
- **恢复权限**: 仅管理员可恢复归档文档
- **恢复通知**: 恢复后自动通知相关用户

---

## 🔗 相关文档

| 文档 | 路径 | 说明 |
|------|------|------|
| **DESIGN.md** | [../../DESIGN.md](../../DESIGN.md#2221-p1-1-document-归档作废功能完整方案) | 原始设计文档 |

---

**文档版本**: v1.0
**最后更新**: 2026-02-13
**下一步**: 阅读 [P1-2_细粒度权限.md](./P1-2_细粒度权限.md)
